# Гистограммы



### Описание
Это тип статистики по столбцам, который предоставляет информацию о распределении данных в столбцах таблицы.


### Типы
  - Частотные и гистограммы верхних частот.
  - Гистограммы с балансировкой по высоте. (устаревшие)
  - Гибридные гистограммы
  
  
### Пример использования. 
Книжный магазин в Калифорнии отправляет 95% книг в Калифорнию, 4% в Орегон, 1% в Неваду. 
Таблица заказов содержит 300 000 строк. В столбце хранится штат, в который отправляются книги.
Пользователь запрашивает кол-во книг, отправленных в Орегон.

Без гистограммы оптимизатор предполагает равномерное распределение 300 000 / 3 (всего 3 штата куда отправляют книги).
Итого оптимизатор оценивает что в Орегон отправляют 100 000 книг. Это 1/3 таблицы. Поэтому оптимизатор выберет полное сканирование таблицы.

С помощью гистограмм оптимизатор видит, что отправляется в Орегон всего 12000 строк (4%). Поэтому выберет индексное сканирование.


### Когда Oracle создает гистограммы
  1. Запросы ссылаются на этот столбец таблицы. То есть в БД есть отметки в sys.col_usage$
  2. Собирается статистика через dbms_stats.